<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<style type="text/css">
	body, html,#map {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
	</style>
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=Oqcpznej7OXFZe8nqaAMeL4lpQ0ttAFr"></script>
	<title>位置</title>
</head>
<body>
	<div id="map"></div>
</body>
</html>
<script type="text/javascript">
	var map = new BMap.Map("map");
	map.centerAndZoom(new BMap.Point(116.404, 39.915), 11);
	document.addEventListener("message", function(event) {
		let data = event.data;
		let obj = JSON.parse(data);
		// alert(obj.fun+'('+data+')')
		obj.fun&&eval(obj.fun+'('+data+')')
  });
  function updatePosition(data)
  {
	  let convertor = new BMap.Convertor();
	  var pointArr= [];
	  pointArr.push(new BMap.Point(data.longitude,data.latitude))
	  convertor.translate(pointArr,1,5,(data)=>
	  {
		if(data.status === 0) {
			map.centerAndZoom(data.points[0], 20);	
      }
	  });
  }
</script>
